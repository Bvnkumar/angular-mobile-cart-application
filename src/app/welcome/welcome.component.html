<section class="catalog-shell page-shell">
  <header class="catalog-header">
    <div class="catalog-header__left">
      <sidebar></sidebar>
      <div class="brand-lockup">
        <p class="brand-kicker">Inspired by food delivery apps</p>
        <h1>MyCart</h1>
      </div>
    </div>
    <div class="catalog-header__right">
      <div class="sort-block">
        <label for="sortbyorder">Sort by</label>
        <div class="sort-select-wrap">
          <select (change)="sortByPrice($event.target)" id="sortbyorder" class="sort-select">
            <option value="LH">Price low to high</option>
            <option value="HL">Price high to low</option>
          </select>
        </div>
      </div>
      <button class="cart-pill" routerLink="/cart" title="Click to view cart items">
        <span class="glyphicon glyphicon-shopping-cart"></span>
        <span>Cart</span>
        <span class="cart-count">{{cartCount}}</span>
      </button>
    </div>
  </header>

  <section class="hero-strip">
    <div>
      <p class="hero-strip__kicker">Fast doorstep delivery</p>
      <h2>Order top mobile picks in 25 mins</h2>
    </div>
    <div class="hero-strip__meta">
      <span><i class="glyphicon glyphicon-certificate"></i> Best rated</span>
      <span><i class="glyphicon glyphicon-time"></i> Quick dispatch</span>
      <span><i class="glyphicon glyphicon-cutlery"></i> Flat 30% off</span>
    </div>
  </section>

  <div class="container-fluid">
    <div class="row">
      <div *ngFor="let product of productList; let idx = index" [ngClass]="getStyle('block')">
        <article class="menu-card" [ngClass]="{'menu-card--list': !!param}">
          <div class="menu-card__badge">Top pick #{{idx + 1}}</div>
          <img src="https://consumer-img.huawei.com/content/dam/huawei-cbg-site/common/support/list-image/phones/Honor%209lite.png"
            class="menu-card__image img-responsive" />
          <div class="menu-card__content">
            <h3>{{product.name}}</h3>
            <p>Trending now. Fast delivery, secure payment and reliable quality checks.</p>
            <div class="menu-card__meta">
              <span><i class="glyphicon glyphicon-star"></i> 4.6</span>
              <span><i class="glyphicon glyphicon-map-marker"></i> 1.2 km</span>
              <span><i class="glyphicon glyphicon-time"></i> 24 min</span>
            </div>
            <div class="menu-card__footer">
              <strong>{{product.currency}}{{product.price}}</strong>
              <div class="menu-card__actions">
                <button type="button" class="menu-card__feedback" (click)="openReviews(product)">Reviews</button>
                <button class="btn btn-brand" (click)="addCart(product.id)">Add to Cart</button>
              </div>
            </div>
          </div>
        </article>
      </div>
    </div>
  </div>

  <div class="checkout-cta">
    <button class="btn btn-brand" routerLink="/cart">Proceed to Checkout</button>
  </div>
</section>

<div *ngIf="isDuplicateModalOpen" class="modal fade in" tabindex="-1" role="dialog" style="display: block;">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closeDuplicateModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">Item already in cart</h4>
      </div>
      <div class="modal-body">
        <p>{{duplicateProduct?.name}} is already in your cart. Add one more?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" (click)="closeDuplicateModal()">Cancel</button>
        <button type="button" class="btn btn-brand" (click)="confirmAddDuplicateProduct()">Add</button>
      </div>
    </div>
  </div>
</div>
<div *ngIf="isDuplicateModalOpen" class="modal-backdrop fade in"></div>

<div *ngIf="isReviewModalOpen" class="modal fade in" tabindex="-1" role="dialog" style="display: block;">
  <div class="modal-dialog" role="document">
    <div class="modal-content review-modal">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closeReviewModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">Reviews: {{selectedReviewProduct?.name}}</h4>
      </div>
      <div class="modal-body review-modal__body">
        <p class="review-modal__caption">Ratings ({{productReviews.length}}) - Tell others what you liked</p>
        <rating (rating)="onReviewRatingChange($event)"></rating>
        <textarea
          rows="4"
          placeholder="Write your review..."
          class="textarea-style review-modal__textarea"
          [(ngModel)]="reviewText"></textarea>

        <section class="review-modal__list">
          <h5>Recent reviews</h5>
          <div *ngIf="productReviews.length; else noReviews">
            <article *ngFor="let review of productReviews; let i = index" class="comments-list">
              <p class="comments-list__name">Customer {{i + 1}}</p>
              <div class="comments-list__stars" *ngIf="review.rating">
                <span class="glyphicon glyphicon-star green-c" *ngFor="let star of getStars(review.rating)"></span>
              </div>
              <p>{{review.comment}}</p>
            </article>
          </div>
          <ng-template #noReviews>
            <p class="comments-empty">No feedback yet. Be the first to review.</p>
          </ng-template>
        </section>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" (click)="closeReviewModal()">Close</button>
        <button type="button" class="btn btn-brand" (click)="submitReview()">Submit</button>
      </div>
    </div>
  </div>
</div>
<div *ngIf="isReviewModalOpen" class="modal-backdrop fade in"></div>
